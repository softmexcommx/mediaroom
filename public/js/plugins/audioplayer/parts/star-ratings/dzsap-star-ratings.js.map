{"version":3,"sources":["../../../../../../../../../../usr/local/lib/node_modules/browserify/node_modules/browser-pack/_prelude.js","dzsap-star-ratings.source.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","window.dzsap_part_starRatings_loaded = 'on';\n\n\nclass dzsapStarRatingsSource {\n  constructor(dzsapClass) {\n\n    this.dzsap = dzsapClass;\n\n    this.init();\n\n\n  }\n\n  init() {\n\n    var $ = jQuery;\n    var starrating_index = 0;\n    var dzsapClass = this.dzsap;\n\n\n    $(document).on('mousemove', '.star-rating-con', mouse_starrating);\n    $(document).on('mouseleave', '.star-rating-con', mouse_starrating);\n    $(document).on('click', '.star-rating-con', mouse_starrating);\n\n    function mouse_starrating(e) {\n      var $t = $(this);\n\n      // console.log('mouse_starrating() ', e.type, $t);\n\n\n      if (dzsapClass.cthis.has($t).length === 0) {\n        return;\n      }\n\n      if (e.type === 'mouseleave') {\n\n\n        var auxnr = Number(dzsapClass.cthis.find('.star-rating-con').eq(0).attr('data-initial-rating-index')) * 100;\n\n\n        // console.log('dzsapClass.starrating_alreadyrated - ',dzsapClass.starrating_alreadyrated);\n        if (dzsapClass.starrating_alreadyrated > -1 && dzsapClass.starrating_alreadyrated > 0) {\n          auxnr = dzsapClass.starrating_alreadyrated * 100 / 5;\n        }\n\n        dzsapClass.cthis.find('.rating-prog').css({\n          'width': auxnr + '%'\n        })\n\n\n        dzsapClass.cthis.find('.star-rating-set-clip').css({\n          'opacity': 1\n        })\n\n      }\n      if (e.type === 'mousemove') {\n        //console.log(_t);\n        var mx = e.pageX - $t.offset().left;\n        var my = e.pageX - $t.offset().left;\n\n        // console.log('Math.round(mx/ (_t.outerWidth()/5)) - ' , Math.round(mx/ (_t.outerWidth()/5)) );\n        // console.log('dzsapClass.starrating_alreadyrated - ' , dzsapClass.starrating_alreadyrated );\n\n\n        starrating_index = Math.round(mx / ($t.outerWidth() / 5));\n\n\n        if (starrating_index > 4) {\n          starrating_index = 5;\n        } else {\n          starrating_index = Math.round(starrating_index);\n        }\n\n        if (starrating_index < 1) {\n          starrating_index = 1;\n        }\n\n        //                    console.log(starrating_index, dzsapClass.cthis.find('.star-rating-prog-clip'));\n\n        // console.log('starrating_index - ',starrating_index);\n        // console.log('(starrating_index/5 * 100) - ',(starrating_index/5 * 100));\n        dzsapClass.cthis.find('.star-rating-prog-clip').css({\n          'width': (starrating_index / 5 * 100) + '%'\n        })\n\n        dzsapClass.starrating_alreadyrated = -1;\n\n\n        dzsapClass.cthis.find('.star-rating-set-clip').css({\n          'opacity': 0\n        })\n      }\n      if (e.type === 'click') {\n\n\n        console.log('dzsapClass.starrating_alreadyrated - ', dzsapClass.starrating_alreadyrated);\n        //todo:remove\n        dzsapClass.starrating_alreadyrated = -1;\n        if (dzsapClass.starrating_alreadyrated > -1 && dzsapClass.starrating_alreadyrated > 0) {\n          return;\n        }\n\n        (ajax_submit_rating.bind(dzsapClass))(starrating_index);\n      }\n\n\n    }\n\n  }\n}\n\nfunction ajax_submit_rating(starrating_index) {\n  //only handles ajax call + result\n  var selfClass = this;\n  var $ = jQuery;\n  var mainarg = starrating_index;\n  var data = {\n    action: 'dzsap_submit_rate',\n    postdata: mainarg,\n    playerid: selfClass.the_player_id\n  };\n\n  //todo:remove\n  // selfClass.starrating_alreadyrated = 0;\n\n  // console.log(selfClass.starrating_alreadyrated);\n  if (selfClass.starrating_alreadyrated > -1) {\n    return;\n  }\n  // console.log(selfClass.starrating_alreadyrated,selfClass.urlToAjaxHandler )\n  selfClass.cthis.find('.star-rating-con').addClass('just-rated');\n  let totalWidth = parseInt(selfClass.cthis.find('.star-rating-bg').width(), 10);\n  if (selfClass.urlToAjaxHandler) {\n    jQuery.ajax({\n      type: \"POST\",\n      url: selfClass.urlToAjaxHandler,\n      data: data,\n      success: function (response) {\n        if (typeof window.console != \"undefined\") {\n          // console.log('Got this from the server: ' + response);\n        }\n        ;\n\n\n        var resp_arr = {};\n\n        try {\n          resp_arr = JSON.parse(response);\n        } catch (e) {\n          console.log(e);\n        }\n\n        var percentSetRating = selfClass.cthis.find('.star-rating-set-clip').outerWidth() / selfClass.cthis.find('.star-rating-bg').outerWidth();\n        var nrrates = parseInt(selfClass.cthis.find('.counter-rates .the-number').html(), 10);\n\n        nrrates++;\n\n        var percentFinalRating = ((nrrates - 1) * (percentSetRating * 5) + starrating_index) / (nrrates)\n\n        // console.log({percentSetRating, aux2: percentFinalRating});\n        //                        console.log(aux, percentFinalRating, nrrates);\n\n        setTimeout(function () {\n\n          selfClass.cthis.find('.star-rating-con').removeClass('just-rated');\n        }, 100);\n        selfClass.cthis.find('.counter-rates .the-number').html(resp_arr.number);\n\n        selfClass.cthis.find('.star-rating-con').attr('data-initial-rating-index', Number(resp_arr.index) / 5);\n        selfClass.cthis.find('.star-rating-con .rating-prog').css('width', (Number(resp_arr.index) / 5 * 100) + '%');\n\n        if (selfClass.initOptions.parentgallery && $(selfClass.initOptions.parentgallery).get(0) !== undefined && $(selfClass.initOptions.parentgallery).get(0).api_player_rateSubmitted !== undefined) {\n          $(selfClass.initOptions.parentgallery).get(0).api_player_rateSubmitted();\n        }\n\n      },\n      error: function (arg) {\n        if (typeof window.console != \"undefined\") {\n          // console.log('Got this from the server: ' + arg, arg);\n        }\n        ;\n\n\n        var widthStarRatingClip = selfClass.selfClass.cthis.find('.star-rating-set-clip').outerWidth() / selfClass.cthis.find('.star-rating-bg').outerWidth();\n        var nrrates = parseInt(selfClass.cthis.find('.counter-rates .the-number').html(), 10);\n\n        nrrates++;\n\n        var aux2 = ((nrrates - 1) * (widthStarRatingClip * 5) + starrating_index) / (nrrates)\n\n        // console.log({aux2});\n\n        //                        console.log(aux, aux2, nrrates);\n        selfClass.cthis.find('.star-rating-set-clip').width(aux2 * (totalWidth / 5));\n        selfClass.cthis.find('.counter-rates .the-number').html(nrrates);\n\n        if (selfClass.initOptions.parentgallery && $(selfClass.initOptions.parentgallery).get(0) !== undefined && $(selfClass.initOptions.parentgallery).get(0).api_player_rateSubmitted !== undefined) {\n          $(selfClass.initOptions.parentgallery).get(0).api_player_rateSubmitted();\n        }\n\n      }\n    });\n  }\n}\n\n\nwindow.dzsap_init_starRatings_from_dzsap = function (dzsapClass) {\n  var dzsapStarRatingsSourceInstance = new dzsapStarRatingsSource(dzsapClass);\n}\n"]}